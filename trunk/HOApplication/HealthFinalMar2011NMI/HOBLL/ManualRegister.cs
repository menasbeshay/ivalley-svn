
// Generated by MyGeneration Version # (1.2.0.7)

using System;
using MHO.DAL;
using System.Data;
using System.Data.SqlClient;
using System.Collections.Specialized;

namespace MHO.BLL
{
	public class ManualRegister : _ManualRegister
	{
		public ManualRegister()
		{
		
		}

        public void DeleteReg(Guid regID)
        {
            SqlDataReader searchResult = null;
            ListDictionary parm = new ListDictionary();
            parm.Add("@RegisterID", regID);
            searchResult = LoadFromSqlReader("ManualRegisterDelete", parm) as SqlDataReader;
            DataTable ResultTable = new DataTable();
            newAdapter da = new newAdapter();
            if (searchResult != null && searchResult.HasRows)
            {
                da.FillFromReader(ResultTable, searchResult);
            }
        }

        public void InsertNewRegister(int _hid,int _year,int _regType, string _regCode)
        {
            SqlDataReader searchResult = null;
            ListDictionary parm = new ListDictionary();
            parm.Add("@hoID", _hid);
            parm.Add("@regType", _regType);
            parm.Add("@regCode", _regCode);
            parm.Add("@regYear", _year);

            searchResult = LoadFromSqlReader("ManualRegisterOpen", parm) as SqlDataReader;
            DataTable ResultTable = new DataTable();
            newAdapter da = new newAdapter();
            if (searchResult != null && searchResult.HasRows)
            {
                da.FillFromReader(ResultTable, searchResult);
            }
        }
	}
}
