
// Generated by MyGeneration Version # (1.3.0.3)

using System;
using Combo.DAL;
using System.Collections.Specialized;
using System.Data.SqlClient;
using System.Data;
namespace Combo.BLL
{
	public class ComboUserFriend : _ComboUserFriend
	{
		public ComboUserFriend()
		{
		
		}

        public virtual bool GetFriendsByUserID(int userid)
        {
            return LoadFromRawSql(@"Select CU.*, A.Path ProfilePic from ComboUserFriend CF
                                    Inner Join ComboUser CU on CF.ComboFriendID = CU.ComboUserID and 
                                                              (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    where CF.ComboUserID = {0} and CF.RequestApproved = 1
                                    union 
                                    Select CU.*, A.Path ProfilePic from ComboUserFriend CF
                                    Inner Join ComboUser CU on CF.ComboUserID = CU.ComboUserID and 
                                                              (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    where CF.ComboFriendID = {0} and CF.RequestApproved = 1", userid);
        }

        public virtual bool SearchForFriendsByUserID(int userid, string searchText)
        {
            // get friends - followers - followings - users 
            /*return LoadFromRawSql(@"Select CU.*, A.Path ProfilePic from ComboUserFriend CF
                                    Inner Join ComboUser CU on CF.ComboFriendID = CU.ComboUserID and 
                                                                (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    where CF.ComboUserID = {0} and CF.RequestApproved = 1 and (cf.isBanned = 1 or cf.isbanned is null) and CU.Username like '%{1}%'
                                    union 
                                    Select CU.*, A.Path ProfilePic from ComboUserFriend CF
                                    Inner Join ComboUser CU on CF.ComboUserID = CU.ComboUserID and 
                                                                (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    where CF.ComboFriendID = {0} and CF.RequestApproved = 1 and (cf.isBanned = 1 or cf.isbanned is null)  and CU.Username like '%{1}%'
                                    union
                                    Select CU.*, A.Path ProfilePic from ProfileFollower PF
                                    Inner Join ComboUser CU on PF.ComboFollowerID = CU.ComboUserID and
                                                                (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    Where PF.ComboUserID = {0} and CU.Username like '%{1}%'
                                    union
                                    Select CU.*, A.Path ProfilePic from ProfileFollower PF
                                    Inner Join ComboUser CU on PF.ComboUserID = CU.ComboUserID and
                                                                (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    Where PF.ComboFollowerID = {0} and CU.Username like '%{1}%'
                                    union 
                                    Select CU.*, A.Path ProfilePic from ComboUser CU                                                                                    
                                    Left join Attachment A on CU.ProfileImgID = A.AttachmentID
                                    where CU.Username like '%{1}%' and (CU.IsDeactivated <> 1 or CU.IsDeactivated is null)
                                    order by Username asc
                                    ", userid, searchText);
            */

            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@UserID", SqlDbType.NVarChar, 200), userid);
            parameters.Add(new SqlParameter("@FilterText", SqlDbType.NVarChar, 200), searchText);
            return LoadFromSql("SearchForFriends", parameters);
        }

        public virtual bool SearchOnFriendsByUserID(int userid, string searchText)
        {            
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@UserID", SqlDbType.NVarChar, 200), userid);
            parameters.Add(new SqlParameter("@FilterText", SqlDbType.NVarChar, 200), searchText);
            return LoadFromSql("SearchOnFriends", parameters);
        }

        public virtual bool SearchForTaggingByUserID(int userid, string searchText, int postid)
        {
            ListDictionary parameters = new ListDictionary();
            parameters.Add(new SqlParameter("@UserID", SqlDbType.Int, 0), userid);
            parameters.Add(new SqlParameter("@FilterText", SqlDbType.NVarChar, 200), searchText);
            parameters.Add(new SqlParameter("@PostID", SqlDbType.Int, 0), postid);
            return LoadFromSql("SearchForTaging", parameters);
        }
	}
}
