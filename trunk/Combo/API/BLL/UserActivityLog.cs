
// Generated by MyGeneration Version # (1.3.0.3)

using System;
using Combo.DAL;
namespace Combo.BLL
{
	public class UserActivityLog : _UserActivityLog
	{
		public UserActivityLog()
		{
		
		}

        public virtual bool GetLastActivityByUserID(int UserID)
        {
            this.Where.ComboUserID.Value = UserID;
            this.Where.ComboUserID.Operator = MyGeneration.dOOdads.WhereParameter.Operand.Equal;
            this.Query.AddOrderBy(ColumnNames.Date, MyGeneration.dOOdads.WhereParameter.Dir.DESC);
            this.Query.Top = 1;
            return this.Query.Load();
        }


        public virtual bool GetActivityDaysByUserID(int UserID)
        {
            return LoadFromRawSql(@"Select IsNull(count(UserActivityLogID) - SUM (ISNull(DaysToDiscount,0)),0) TotalActivityDays from UserActivityLog Where ComboUserID = {0}", UserID);
        }
	}
}
