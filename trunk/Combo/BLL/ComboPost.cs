
// Generated by MyGeneration Version # (1.3.0.3)

using System;
using Combo.DAL;
namespace Combo.BLL
{
	public class ComboPost : _ComboPost
	{
		public ComboPost()
		{
		
		}

        public virtual bool GetPostByUserID(int userid)
        {
            return LoadFromRawSql(@"Select P.*, U.UserName, A.Path ProfilePic from ComboPost P
                                    Inner Join ComboUser U on P.ComboUserID = U.ComboUserID
                                    Left join Attachment A on U.ProfileImgID = A.AttachmentID
                                    Where P.ComboUserID = {0} and 
                                    (P.IsDeleted <> 1 or P.IsDeleted is null) 
                                    order by P.PostDate Desc", userid);
        }

        public virtual bool GetFollowingPostsByUserID(int userid)
        {
            return LoadFromRawSql(@"Select P.*, U.UserName, A.Path ProfilePic from ComboPost P
                                    Inner Join ComboUser U on P.ComboUserID = U.ComboUserID
                                    Left join Attachment A on U.ProfileImgID = A.AttachmentID
                                    Where P.ComboUserID in (select ComboFollowerID from ProfileFollower PF where PF.ComboUserID = {0}) and 
                                    (P.IsDeleted <> 1 or P.IsDeleted is null)
                                    order by P.PostDate Desc", userid);
        }

        public virtual bool GetFriendsPostsByUserID(int userid)
        {
            return LoadFromRawSql(@"Select P.*, U.UserName, A.Path ProfilePic 
                                    from ComboPost P
                                    Inner Join ComboUser U on P.ComboUserID = U.ComboUserID
                                    Left join Attachment A on U.ProfileImgID = A.AttachmentID
                                    inner join ComboUserFriend CF on U.ComboUserID = CF.ComboFriendID and 
								                                     CF.ComboUserID = {0}							 
                                    where (P.IsDeleted <> 1 or P.IsDeleted is null)

                                    union 
                                    Select P.*, U.UserName, A.Path ProfilePic 
                                    from ComboPost P
                                    Inner Join ComboUser U on P.ComboUserID = U.ComboUserID
                                    Left join Attachment A on U.ProfileImgID = A.AttachmentID
                                    Inner join ComboUserFriend CFF on U.ComboUserID = CFF.ComboUserID and
								                                      CFF.ComboFriendID = {0}
                                    where (P.IsDeleted <> 1 or P.IsDeleted is null)
                                    order by P.PostDate Desc", userid);
        }

        public virtual bool GetPostByID(int pid)
        {
            return LoadFromRawSql(@"Select P.*, U.UserName, A.Path ProfilePic from ComboPost P
                                    Inner Join ComboUser U on P.ComboUserID = U.ComboUserID
                                    Left join Attachment A on U.ProfileImgID = A.AttachmentID
                                    Where P.ComboPostID = {0} and 
                                    (P.IsDeleted <> 1 or P.IsDeleted is null)", pid);
        }

	}
}
